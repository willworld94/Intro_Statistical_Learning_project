##Importance 
```{r}
library(caret)
library(mlbench)
library(ISLR)
library(gbm)

team_data = read.csv('New_Team.csv')
set.seed(26)
pts_idx = createDataPartition(team_data$pts, p = 0.6, list = FALSE)
pts_trn = team_data[pts_idx,]
pts_tst = team_data[-pts_idx,]
cv_5 = trainControl(method = "cv", number = 5)
gbm_grid = expand.grid(interaction.depth = c(1, 2),
                       n.trees = c(500, 1000, 1500),
                       shrinkage = c(0.001, 0.01, 0.1),
                       n.minobsinnode = 10)
gbm_tune = train(pts ~ ., data = pts_trn,
                 method = "gbm",
                 trControl = cv_5,
                 verbose = FALSE,
                 tuneGrid = gbm_grid)
summary(gbm_tune)

##rf
rf_grid = expand.grid(mtry = c(1, 2, 3, 4))
rf_small = train(pts ~ td + fgm + spp + pc, data = pts_trn, trControl = cv_5, method = "rf", tuneGrid = rf_grid)

rf_int = train(pts ~ td + fgm + spp + pc + td:spp + fgm:spp + td:pc + fgm:pc, data = pts_trn, trControl = cv_5, method = "rf", tuneGrid = rf_grid)


##GAMs
gam_grid = expand.grid(df = 1:10)
gam_small = train(pts ~ td + fgm, data = pts_trn, trControl = cv_5, 
                  method = "gamSpline", tuneGrid = gam_grid)

gam_full = train(pts ~ ., data = pts_trn, trControl = cv_5, 
                  method = "gamSpline", tuneGrid = gam_grid)

##RMSE
rmse = function(actual, predicted) {
  sqrt(mean((actual - predicted) ^ 2))
}

#--Random Forest RMSE--#
rf_pred = predict(rf_small, newdata = pts_tst)
rf_rmse = rmse(actual = pts_tst$pts, predicted = rf_pred)
rf_cv = get_best_result(rf_small)
rf_cv_rmse = rf_cv$RMSE

rf_int_pred = predict(rf_int, newdata = pts_tst)
rf_int_rmse = rmse(actual = pts_tst$pts, predicted = rf_int_pred)
rf_cv_int = get_best_result(rf_int)
rf_cv_int_rmse = rf_cv_int$RMSE

#--GAMs Small RMSE--#
gam_pred = predict(gam_small, newdata = pts_tst)
gam_rmse = rmse(actual = pts_tst$pts, predicted = gam_pred)
gam_cv = get_best_result(gam_small)
gam_cv_rmse = gam_cv$RMSE

#--GAMs Full RMSE--#
gam_full_pred = predict(gam_full, newdata = pts_tst)
gam_full_rmse = rmse(actual = pts_tst$pts, predicted = gam_full_pred)
gam_cv_full = get_best_result(gam_full)
gam_cv_full_rmse = gam_cv_full$RMSE
```

